This script is based on 
